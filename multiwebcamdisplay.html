<!DOCTYPE html>
<html>
<head>
    <title>Multiple Webcams</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        #webcams {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            padding: 10px;
        }
        video {
            width: 240px;
            height: 180px;
            border: 1px solid #ccc;
            margin: auto;
        }
    </style>
</head>
<body>

<div id="webcams">
    <!-- Webcam video elements will be appended here -->
</div>

<script>
async function startWebcams() {
    const devices = await navigator.mediaDevices.enumerateDevices();
    const videoDevices = devices.filter(device => device.kind === 'videoinput');

    console.log("Enumerated devices:", devices);
    console.log("Filtered video devices:", videoDevices);

    if(videoDevices.length === 0) {
        console.log("No video devices found");
        return;
    }

    videoDevices.forEach(async (device, index) => {
        try {
            console.log(`Trying to initialize device with id ${device.deviceId}`);
            const videoElement = document.createElement('video');
            videoElement.id = `webcam${index}`;
            videoElement.width = 240;
            videoElement.height = 180;
            videoElement.autoplay = true;

            document.getElementById('webcams').appendChild(videoElement);

            const stream = await navigator.mediaDevices.getUserMedia({
                video: {
                    deviceId: device.deviceId
                }
            });

            videoElement.srcObject = stream;
            console.log(`Successfully initialized device with id ${device.deviceId}`);
        } catch (err) {
            console.error(`Failed to initialize device with id ${device.deviceId}: ${err}`);
        }
    });
}

startWebcams();

</script>

</body>
</html>
